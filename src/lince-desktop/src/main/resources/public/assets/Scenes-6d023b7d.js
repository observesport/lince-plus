import{b9 as L,bs as x,r as m,ah as D,ba as M,ag as e,ap as t,bt as l,bb as F,bc as E,be as A,a3 as j,a0 as p,bu as $,bv as B,a7 as f,bw as z,bx as N,bd as q,by as h,bf as H,bz as T,bA as S,bB as I,a_ as O}from"./index-b2960181.js";import{M as U}from"./index-0a8e75a8.js";import{D as W}from"./index-0990db38.js";import"./context-e5dbd941.js";const G=i=>L({title:"Scene program",type:"object",properties:{time:{title:`${x.t("uniforms.label.scene")} (s)`,type:"integer",default:5,minimum:5,maximum:i},startTime:{title:`${x.t("uniforms.label.startTime")} (s)`,type:"integer",default:5,minimum:0,maximum:i},endTime:{title:`${x.t("uniforms.label.endTime")} (s)`,type:"integer",default:5,minimum:1,maximum:i}},required:["time","startTime","endTime"]}),J=()=>{const[i,c]=m.useState({date:new Date,modalVisible:!1,panelVisible:!1,duration:1,sceneProgram:{},tool:{}}),a=m.useRef(null),y=m.useRef(null),b=D();m.useEffect(()=>{M()},[]);const v=s=>{var n;(n=a.current)==null||n.doPlayScene(s.videoTime)},P=()=>{var r,o;let s=((r=a.current)==null?void 0:r.getCurrentTime())||0;(o=a.current)==null||o._doPlay(),b(T({moment:s})),u(),S(e.jsx(t,{id:"notification.saved-scene"}),e.jsx(t,{id:"notification.saved-scene.description-1",time:l(s)}))},C=s=>{s.startTime>s.endTime?I(e.jsx(t,{id:"notification.scene-programming"}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx(t,{id:"correct-planning-time-1"}),","]}),e.jsxs("p",{children:[e.jsx(t,{id:"correct-planning-time-2"}),","]})]})):c({...i,modalVisible:!0,sceneProgram:s})},w=()=>{const{startTime:s,endTime:n,time:r}=i.sceneProgram;if(s<n){let o=Math.round((n-s)/r);for(let d=0;d<o;d++){let k={moment:s+d*r,name:"Auto-scene "+d};b(T(k))}S(e.jsx(t,{id:"notification.scene-programming"}),e.jsx(t,{id:"notification.scene-programming.created-scenes",number:o}))}u()},u=()=>{c({...i,modalVisible:!1,sceneProgram:{}})},R=()=>{c({...i,panelVisible:!0})},V=()=>{c({...i,panelVisible:!1})},_=(()=>{const s=a.current?a.current.getVideoLength():60;return G(s)})();let g="";if(i.sceneProgram){const{startTime:s,endTime:n,time:r}=i.sceneProgram;g=e.jsxs("div",{children:[e.jsx(t,{id:"accept-automatic-generation.description-1",number:Math.round((n-s)/r)}),e.jsx("p",{children:e.jsx(t,{id:"accept-automatic-generation.description-2",startTime:l(s),endTime:l(n),intervalTime:l(r)})})]})}return e.jsx(F,{style:{height:"100vh"},children:e.jsxs(E,{children:[e.jsx(A,{children:e.jsx(t,{id:"scenes"})}),e.jsxs(j,{children:[e.jsx(p,{md:12,children:e.jsx($,{ref:a,defaultSize:24})}),e.jsxs(p,{md:12,children:[e.jsx(j,{children:e.jsxs(B,{md:24,children:[e.jsx(f,{type:"primary",onClick:()=>P(),children:e.jsx(t,{id:"save-current-position"})}),"Â ",e.jsx(f,{type:"primary",onClick:()=>R(),icon:e.jsx(z,{}),children:e.jsx("span",{children:e.jsx(t,{id:"schedule-scenes"})})})]})}),e.jsx(j,{children:e.jsx(p,{md:24,children:e.jsx(N,{ref:y,fullMode:!1,onPlayRegister:v})})})]})]}),e.jsx(U,{centered:!0,title:e.jsx(t,{id:"accept-automatic-generation"}),open:i.modalVisible,onOk:()=>w(),onCancel:()=>u(),children:e.jsx("div",{children:g})}),e.jsx(W,{title:e.jsx(t,{id:"schedule-scenes"}),width:520,closable:!0,onClose:V,open:i.panelVisible,children:e.jsxs(q,{schema:_,onSubmit:s=>C(s),children:[e.jsx(h,{name:"time"}),e.jsx(h,{name:"startTime"}),e.jsx(h,{name:"endTime"}),e.jsx(H,{value:e.jsx(t,{id:"Submit"})})]})})]})})},se=()=>e.jsxs(e.Fragment,{children:[e.jsx(O,{pageName:e.jsx(t,{id:"scenes"})}),e.jsx("div",{className:"overflow-hidden rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark",children:e.jsx(J,{})})]});export{se as default};
