import{U as P,Q as M,cI as Y,d as a,b$ as $,c0 as V,cJ as I,J as s,cK as J,cL as r,R as y,n as g,cM as Q,aa as q,cN as G,bh as X,bU as ee,bV as te,cx as se,bY as re,cy as ie,aQ as oe}from"./index-Cp-dRVR4.js";import{L as ne}from"./index-Dy7lzpUN.js";const n={NORMAL_SPEED:1,SLOW_SPEED:.5,STEP:5,STEP_MICRO:.1,SIZE_FULL:24,SIZE_MEDIUM:12,SIZE_SMALL:8},ae=({keyboard:x=[r.playKey,r.pauseKey,r.stopKey,r.videoResizeHalfKey,r.videoResizeFullKey,r.videoResizeThirdKey,r.normalSpeedKey,r.halfSpeedKey,r.jumpBackKey,r.jumpForwardKey,r.leftKey,r.rightKey],defaultSize:m=n.SIZE_MEDIUM,autoPlay:c=!1})=>{const _=P(e=>e.lince.videos),v=P(e=>e.lince.register),w=v.map(e=>({time:e.videoTime,text:e.videoTimeTxt||""})),A=v.map((e,t)=>({id:e.id,startTime:e.videoTime,title:e.videoTimeTxt||`Scene ${t+1}`})),S=M(),{registerVideoPlayer:R,unregisterVideoPlayer:j}=Y(),[T,z]=a.useState(!0),[k,D]=a.useState(m),[o,C]=a.useState([]),l=a.useRef(null),d=e=>{o.forEach(t=>{t.ref.current&&e(t,t.ref.current)})},u=e=>{e&&e>=0&&(l.current=e,d((t,i)=>{i.pause(),i.setTime(e)}))},K=()=>{try{if(o&&o.length>0){const t=o[0].ref.current;if(t)return t.getCurrentTime()}}catch(t){console.log(t)}return 0},F=()=>{try{if(o&&o.length>0){const t=o[0].ref.current;if(t)return t.getDuration()||0}}catch(t){console.log(t)}return 0},U=()=>{let e=!0,t=0;d((i,f)=>{e?(e=!1,t=f.getCurrentTime()):f.setTime(t)})},h=()=>{d((e,t)=>{t.play()})},b=()=>{d((e,t)=>{t.pause()})},L=()=>{d((e,t)=>{t.stop()})},Z=()=>{z(!T),d((e,t)=>{t.toggleMute()})},E=e=>{d((t,i)=>{i.setPlaybackRate(e)})},p=e=>{D(e)},O=(e,t,i)=>{const f=I.isYoutubeVideo(t),H=f?t:q.url.API_BASE_URL+t,N=f?"youtube":"file",W=k===n.SIZE_FULL;return s.jsx(g,{span:k,children:s.jsx("div",{style:{width:"100%"},children:s.jsx(G,{ref:i,videoSource:H,playerType:N,chapters:A,markers:w,muted:T,autoPlay:c,showTabs:W})})},e)},B=(e,t)=>{const i=()=>l.current!==null?l.current:K();switch(e){case r.playKey:h(),l.current=null;break;case r.pauseKey:b();break;case r.stopKey:L(),l.current=null;break;case r.videoResizeFullKey:p(n.SIZE_FULL);break;case r.videoResizeHalfKey:p(n.SIZE_MEDIUM);break;case r.videoResizeThirdKey:p(n.SIZE_SMALL);break;case r.normalSpeedKey:E(n.NORMAL_SPEED);break;case r.halfSpeedKey:E(n.SLOW_SPEED);break;case r.jumpBackKey:u(i()-n.STEP);break;case r.jumpForwardKey:u(i()+n.STEP);break;case r.leftKey:u(i()-n.STEP_MICRO);break;case r.rightKey:u(i()+n.STEP_MICRO);break}return!1};return a.useEffect(()=>{S($()),S(V())},[S]),a.useEffect(()=>{const e=_.map(t=>{const i=I.isYoutubeVideo(t.url);return{id:t.id,url:t.url,type:i?"youtube":"file",ref:a.createRef()}});C(e)},[_]),a.useEffect(()=>{if(o.length>0)return R({playScene:u,play:h,pause:b,getCurrentTime:K,getVideoDuration:F}),()=>{j()}},[R,j,o]),a.useEffect(()=>{c&&o.length>0&&h()},[c,o]),s.jsxs(s.Fragment,{children:[s.jsx(J,{handleKeys:x,onKeyEvent:(e,t)=>B(e)}),s.jsx(y,{children:s.jsx(g,{span:24,children:s.jsx(Q,{onSoundTo:Z,onSync:U,onSetPlayBack:E,onStop:L,onPause:b,onPlay:h,onResize:p})})}),s.jsx(y,{children:o.map(e=>O(e.id,e.url,e.ref))})]})},ce=({className:x,style:m})=>{const c=M();return a.useEffect(()=>{c(X()),c(V()),ee()},[c]),s.jsx(te,{children:s.jsx(ne,{className:x,style:{...m,height:"100%",overflow:"hidden",padding:0},children:s.jsxs("div",{style:{display:"flex",width:"100%",height:"calc(100% - 60px)",overflow:"hidden"},children:[s.jsx(se,{defaultSize:{width:"65%",height:"100%"},minWidth:"400",minHeight:"500",maxWidth:"80%",enable:{right:!0,top:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},children:s.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[s.jsx(y,{style:{minHeight:"400px",flex:"0 0 auto"},gutter:0,children:s.jsx(g,{span:24,style:{height:"auto"},children:s.jsx(ae,{defaultSize:12})})}),s.jsx(y,{style:{flex:"1 1 auto",overflow:"auto",marginTop:"8px"},gutter:0,children:s.jsx(g,{span:24,children:s.jsx(re,{})})})]})}),s.jsx("div",{style:{flex:1,minWidth:"300px",overflow:"hidden",display:"flex",flexDirection:"column",paddingLeft:"8px"},children:s.jsx(ie,{})})]})})})},ue=()=>s.jsxs(s.Fragment,{children:[s.jsx(oe,{pageName:"AIStudio"}),s.jsx("div",{className:"overflow-hidden rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark",children:s.jsx(ce,{})})]});export{ue as default};
